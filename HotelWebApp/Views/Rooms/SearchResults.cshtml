@model IEnumerable<HotelWebApp.Data.Entities.Room>

@{
    ViewData["Title"] = "Available Rooms";
    var checkIn = (DateTime)ViewBag.CheckInDate;
    var checkOut = (DateTime)ViewBag.CheckOutDate;
}

<div class="text-center my-5">
    <h1 class="display-4 fw-bold">@ViewData["Title"]</h1>
    <p class="lead text-muted">
        Showing available rooms from <strong>@checkIn.ToShortDateString()</strong> to <strong>@checkOut.ToShortDateString()</strong>
    </p>
</div>

@if (!Model.Any())
{
    <div class="alert alert-warning text-center">
        <p>Sorry, no rooms are available for the selected dates.</p>
        <a asp-controller="Home" asp-action="Index" class="btn btn-primary">Try Different Dates</a>
    </div>
}
else
{
    <div class="container">
        <div class="row">
            @foreach (var room in Model)
            {
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card h-100 shadow-sm border-0">

                        @{
                            var imagePath = "~/images/rooms/" + (room.ImageUrl ?? "default-room.jpg");
                        }
                        <img src="@Url.Content(imagePath)" class="card-img-top" alt="Image of a @room.Type room"
                             style="height: 220px; object-fit: cover;" asp-append-version="true">

                        <div class="card-body d-flex flex-column p-4">

                            <h5 class="card-title">@room.Type.ToString() Room</h5>
                            <h6 class="card-subtitle mb-3 text-muted">Room Number: @room.RoomNumber</h6>

                            <ul class="list-unstyled mt-3 mb-4">
                                <li><i class="fas fa-users text-muted me-2"></i> Up to @room.Capacity guests</li>
                            </ul>

                            <div class="mt-auto text-center">
                                <h3 class="pricing-card-title">@room.PricePerNight.ToString("C") <small class="text-muted fw-light">/ night</small></h3>

                                <a asp-controller="Reservations" asp-action="Create"
                                   asp-route-roomId="@room.Id"
                                   asp-route-checkInDate="@checkIn.ToString("yyyy-MM-dd")"
                                   asp-route-checkOutDate="@checkOut.ToString("yyyy-MM-dd")"
                                   class="btn btn-primary w-100">
                                    Reserve Now
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}